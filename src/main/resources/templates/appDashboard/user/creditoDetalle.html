<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      th:replace="~{appDashboard/user/layout :: layout(
          pageTitle='Detalle de Crédito',
          pageSubtitle='Detalle de tu solicitud',
          activePage='estadoCreditos',
          content=~{::content},
          pageCss=~{::css},
          pageScripts=~{::scripts}
      )}">
<head>
    <meta charset="UTF-8">
    <title>Detalle de Crédito</title>
    <link href="/appDashboard/admin/dist/css/creditoDetalle.css" rel="stylesheet" type="text/css" />
</head>
<body>
    <div th:fragment="content" class="credit-detail-container">
        <!-- Credit Summary Section -->
        <div class="detail-section">
            <div class="section-header" id="credit-summary-toggle" onclick="toggleSection('credit-summary')">
                <i class="fas fa-file-alt"></i>
                <span>Resumen del Crédito</span>
                <i class="fas fa-chevron-down toggle-icon"></i>
            </div>
            <div class="section-content" id="credit-summary-content">
                <div class="detail-grid">
                    <div class="detail-item">
                        <div class="detail-label">Monto Solicitado</div>
                        <div class="detail-value" th:text="${'$' + #numbers.formatDecimal(credito.monto, 1, 'COMMA', 2, 'POINT')}"></div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">Plazo</div>
                        <div class="detail-value" th:text="${credito.plazoMeses + ' meses'}"></div>
                    </div>
                    <!-- Calculated Financial Amounts -->
                    <div th:if="${credito.interes != null}" class="detail-item">
                        <div class="detail-label">Monto Interés</div>
                        <div class="detail-value" th:text="${'$' + #numbers.formatDecimal(credito.interes, 1, 'COMMA', 2, 'POINT')}"></div>
                    </div>
                    <div th:if="${credito.mora != null}" class="detail-item">
                        <div class="detail-label">Monto Mora</div>
                        <div class="detail-value" th:text="${'$' + #numbers.formatDecimal(credito.mora, 1, 'COMMA', 2, 'POINT')}"></div>
                    </div>
                    <div th:if="${credito.iva != null}" class="detail-item">
                        <div class="detail-label">Monto IVA</div>
                        <div class="detail-value" th:text="${'$' + #numbers.formatDecimal(credito.iva, 1, 'COMMA', 2, 'POINT')}"></div>
                    </div>
                    <div th:if="${credito.total != null}" class="detail-item">
                        <div class="detail-label">Monto Total</div>
                        <div class="detail-value" th:text="${'$' + #numbers.formatDecimal(credito.total, 1, 'COMMA', 2, 'POINT')}"></div>
                    </div>
                </div>

                <!-- Financial Charges Details -->
                <div th:if="${credito.porcentajeInteres != null}">
                    <hr class="my-3">
                    <h6 class="text-muted mb-3">Cargos Financieros</h6>
                    <div class="detail-grid">
                        <!-- Configurable Percentages -->
                        <div class="detail-item">
                            <div class="detail-label">Porcentaje Interés</div>
                            <div class="detail-value" th:text="${#numbers.formatDecimal(credito.porcentajeInteres, 1, 2) + '%'}"></div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Porcentaje Mora</div>
                            <div class="detail-value" th:text="${#numbers.formatDecimal(credito.porcentajeMora, 1, 2) + '%'}"></div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Porcentaje IVA</div>
                            <div class="detail-value" th:text="${#numbers.formatDecimal(credito.porcentajeIva, 1, 2) + '%'}"></div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Comisión Fija</div>
                            <div class="detail-value" th:text="${'$' + #numbers.formatDecimal(credito.comisionFija, 1, 'COMMA', 2, 'POINT')}"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Credit Details Section -->
        <div class="detail-section">
            <div class="section-header" id="credit-details-toggle" onclick="toggleSection('credit-details')">
                <i class="fas fa-info-circle"></i>
                <span>Detalles del Crédito</span>
                <i class="fas fa-chevron-down toggle-icon"></i>
            </div>
            <div class="section-content" id="credit-details-content">
                <div class="detail-grid">
                    <div class="detail-item">
                        <div class="detail-label">Destino del Crédito</div>
                        <div class="detail-value" th:text="${credito.destino != null ? credito.destino : 'No especificado'}"></div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">Forma de Pago</div>
                        <div class="detail-value" th:text="${credito.formaDePago != null ? credito.formaDePago : 'No especificado'}"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="sections-grid">
            <!-- Personal Information -->
            <div class="section-card" th:if="${credito.usuarioSolicitud != null}">
                <div class="section-header" onclick="toggleSection('personal-info')">
                    <div class="section-header-left">
                        <i class="fas fa-user"></i>
                        Información Personal
                    </div>
                    <button class="section-toggle collapsed" id="personal-info-toggle">
                        <i class="fas fa-chevron-down"></i>
                    </button>
                </div>
                <div class="section-content" id="personal-info-content" style="max-height: 0px; padding-top: 0px; padding-bottom: 0px; overflow: hidden;">
                    <div class="info-grid">
                        <div class="info-item important-field">
                            <span class="info-label">Nombres</span>
                            <span class="info-value" th:text="${credito.usuarioSolicitud.nombres}">Juan Carlos</span>
                        </div>
                        <div class="info-item important-field">
                            <span class="info-label">Apellidos</span>
                            <span class="info-value" th:text="${credito.usuarioSolicitud.apellidos}">Pérez González</span>
                        </div>
                        <div class="info-item important-field">
                            <span class="info-label">Número de DUI</span>
                            <span class="info-value" th:text="${credito.usuarioSolicitud.dui}">12345678-9</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Número de NIT</span>
                            <span class="info-value" th:text="${credito.usuarioSolicitud.nit}">1234-567890-123-4</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Fecha de Nacimiento</span>
                            <span class="info-value" th:text="${credito.usuarioSolicitud.fechaNacimiento}">15/03/1985</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Estado Civil</span>
                            <span class="info-value" th:text="${credito.usuarioSolicitud.estadoCivil}">Casado</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- User Account Information -->
            <div class="section-card" th:if="${credito.usuario != null}">
                <div class="section-header" onclick="toggleSection('account-info')">
                    <div class="section-header-left">
                        <i class="fas fa-user-circle"></i>
                        Información de la Cuenta
                    </div>
                    <button class="section-toggle collapsed" id="account-info-toggle">
                        <i class="fas fa-chevron-down"></i>
                    </button>
                </div>
                <div class="section-content" id="account-info-content" style="max-height: 0px; padding-top: 0px; padding-bottom: 0px; overflow: hidden;">
                    <div class="info-grid">
                        <div class="info-item important-field">
                            <span class="info-label">Nombre Completo</span>
                            <span class="info-value" th:text="${credito.usuario.nombre != null ? credito.usuario.nombre : 'N/A'}">Juan Pérez</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Correo Electrónico</span>
                            <span class="info-value" th:text="${credito.usuario.email != null ? credito.usuario.email : 'N/A'}">juan@email.com</span>
                            <div class="contact-info">
                                <i class="fas fa-envelope contact-icon"></i>
                                <span style="font-size: 12px; color: #6c757d;">Correo principal</span>
                            </div>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Teléfono Móvil</span>
                            <span class="info-value" th:text="${credito.usuario.celular != null ? credito.usuario.celular : 'N/A'}">+503 1234-5678</span>
                            <div class="contact-info">
                                <i class="fas fa-phone contact-icon"></i>
                                <span style="font-size: 12px; color: #6c757d;">Contacto principal</span>
                            </div>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Dirección Residencial</span>
                            <span class="info-value" th:text="${credito.usuario.direccion != null ? credito.usuario.direccion : 'N/A'}">San Salvador, El Salvador</span>
                            <div class="contact-info">
                                <i class="fas fa-map-marker-alt contact-icon"></i>
                                <span style="font-size: 12px; color: #6c757d;">Dirección registrada</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Work Information -->
            <div class="section-card" th:if="${credito.usuarioSolicitud != null}">
                <div class="section-header" onclick="toggleSection('work-info')">
                    <div class="section-header-left">
                        <i class="fas fa-briefcase"></i>
                        Información Laboral
                    </div>
                    <button class="section-toggle collapsed" id="work-info-toggle">
                        <i class="fas fa-chevron-down"></i>
                    </button>
                </div>
                <div class="section-content" id="work-info-content" style="max-height: 0px; padding-top: 0px; padding-bottom: 0px; overflow: hidden;">
                    <div class="info-grid">
                        <div class="info-item">
                            <span class="info-label">Empresa o Institución</span>
                            <span class="info-value" th:text="${credito.usuarioSolicitud.empresaTrabajo}">Tech Solutions S.A.</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Cargo o Puesto</span>
                            <span class="info-value" th:text="${credito.usuarioSolicitud.puesto}">Desarrollador Senior</span>
                        </div>
                        <div class="info-item financial-field">
                            <span class="info-label">Ingreso Mensual</span>
                            <span class="info-value amount-highlight" th:text="${'$' + credito.usuarioSolicitud.ingresoMensual}">$2,500.00</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Tipo de Contrato</span>
                            <span class="info-value" th:text="${credito.usuarioSolicitud.tipoContrato}">Indefinido</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Contact Information -->
            <div class="section-card" th:if="${credito.usuarioSolicitud != null}">
                <div class="section-header" onclick="toggleSection('contact-info')">
                    <div class="section-header-left">
                        <i class="fas fa-address-book"></i>
                        Información de Contacto
                    </div>
                    <button class="section-toggle collapsed" id="contact-info-toggle">
                        <i class="fas fa-chevron-down"></i>
                    </button>
                </div>
                <div class="section-content" id="contact-info-content" style="max-height: 0px; padding-top: 0px; padding-bottom: 0px; overflow: hidden;">
                    <div class="info-grid">
                        <div class="info-item">
                            <span class="info-label">Teléfono de Contacto</span>
                            <span class="info-value" th:text="${credito.usuarioSolicitud.telefono}">+503 1234-5678</span>
                            <div class="contact-info">
                                <i class="fas fa-phone contact-icon"></i>
                                <span style="font-size: 12px; color: #6c757d;">Teléfono de la solicitud</span>
                            </div>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Correo Electrónico</span>
                            <span class="info-value" th:text="${credito.usuarioSolicitud.email}">juan@email.com</span>
                            <div class="contact-info">
                                <i class="fas fa-envelope contact-icon"></i>
                                <span style="font-size: 12px; color: #6c757d;">Email de la solicitud</span>
                            </div>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Dirección Residencial</span>
                            <span class="info-value" th:text="${credito.usuarioSolicitud.direccion}">San Salvador, El Salvador</span>
                            <div class="contact-info">
                                <i class="fas fa-map-marker-alt contact-icon"></i>
                                <span style="font-size: 12px; color: #6c757d;">Dirección de la solicitud</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- References -->
        <div class="section-card" th:if="${credito.usuarioSolicitud != null}">
            <div class="section-header" onclick="toggleSection('references')">
                <div class="section-header-left">
                    <i class="fas fa-users"></i>
                    Referencias Personales
                </div>
                <button class="section-toggle collapsed" id="references-toggle">
                    <i class="fas fa-chevron-down"></i>
                </button>
            </div>
            <div class="section-content" id="references-content" style="max-height: 0px; padding-top: 0px; padding-bottom: 0px; overflow: hidden;">
                <div class="info-grid" style="grid-template-columns: 1fr 1fr;">
                    <div class="info-item">
                        <span class="info-label">Primera Referencia</span>
                        <span class="info-value" th:text="${credito.usuarioSolicitud.referencia1}">María González</span>
                        <div class="contact-info">
                            <i class="fas fa-phone contact-icon"></i>
                            <span class="info-value" th:text="${credito.usuarioSolicitud.telefonoReferencia1}">+503 9876-5432</span>
                        </div>
                        <span class="info-label" style="margin-top: 6px;">Relación</span>
                        <span class="info-value" th:text="${credito.usuarioSolicitud.parentesco1}">Hermana</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Segunda Referencia</span>
                        <span class="info-value" th:text="${credito.usuarioSolicitud.referencia2}">Carlos Rodríguez</span>
                        <div class="contact-info">
                            <i class="fas fa-phone contact-icon"></i>
                            <span class="info-value" th:text="${credito.usuarioSolicitud.telefonoReferencia2}">+503 5555-1234</span>
                        </div>
                        <span class="info-label" style="margin-top: 6px;">Relación</span>
                        <span class="info-value" th:text="${credito.usuarioSolicitud.parentesco2}">Amigo</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Application Details -->
        <div class="section-card" th:if="${credito.usuarioSolicitud != null}">
            <div class="section-header" onclick="toggleSection('application-details')">
                <div class="section-header-left">
                    <i class="fas fa-clipboard-check"></i>
                    Detalles de la Solicitud
                </div>
                <button class="section-toggle collapsed" id="application-details-toggle">
                    <i class="fas fa-chevron-down"></i>
                </button>
            </div>
            <div class="section-content" id="application-details-content" style="max-height: 0px; padding-top: 0px; padding-bottom: 0px; overflow: hidden;">
                <div class="info-grid" style="grid-template-columns: 1fr 1fr;">
                    <div class="info-item">
                        <span class="info-label">Firma del Solicitante</span>
                        <span class="info-value" th:text="${credito.usuarioSolicitud.firma}">Juan C. Pérez</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Fecha de Solicitud</span>
                        <span class="info-value" th:text="${credito.usuarioSolicitud.fechaSolicitud}">15/01/2024</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html> 