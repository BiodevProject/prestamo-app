<div class="credito-detail">
    <!-- Credit Summary -->
    <div class="section-card full-width">
        <div class="section-header" onclick="toggleSection('credit-summary')">
            <div class="section-header-left">
                <i class="fas fa-file-invoice-dollar"></i>
                Resumen del Crédito
            </div>
            <button class="section-toggle" id="credit-summary-toggle">
                <i class="fas fa-chevron-down"></i>
            </button>
        </div>
        <div class="section-content" id="credit-summary-content">
            <div class="summary-grid">
                <div class="summary-item financial-field monto-highlight">
                    <div class="summary-label">Monto Solicitado</div>
                    <div class="summary-value" th:text="${'$' + #numbers.formatDecimal(credito.monto, 1, 'COMMA', 2, 'POINT')}">$1,000.00</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Identificador</div>
                    <div class="summary-value" th:text="${credito.id}">123</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Estado</div>
                    <div class="summary-value">
                        <span class="status-badge" th:class="${'status-' + credito.estado}" th:text="${credito.estado}">Pendiente</span>
                    </div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Plazo</div>
                    <div class="summary-value" th:text="${credito.plazoMeses + ' meses'}">12 meses</div>
                </div>
                <div th:if="${credito.cuotaMensual != null}" class="summary-item financial-field">
                    <div class="summary-label">Cuota Mensual</div>
                    <div class="summary-value" th:text="${'$' + #numbers.formatDecimal(credito.cuotaMensual, 1, 'COMMA', 2, 'POINT')}"></div>
                </div>
                <!-- Status Dates -->
                <div th:if="${credito.fechaAceptado != null}" class="summary-item">
                    <div class="summary-label">Fecha de Aceptación</div>
                    <div class="summary-value" th:text="${#temporals.format(credito.fechaAceptado, 'dd/MM/yyyy HH:mm')}"></div>
                </div>
                <div th:if="${credito.fechaFinalizado != null}" class="summary-item">
                    <div class="summary-label">Fecha de Finalización</div>
                    <div class="summary-value" th:text="${#temporals.format(credito.fechaFinalizado, 'dd/MM/yyyy HH:mm')}"></div>
                </div>
                <!-- Calculated Financial Amounts -->
                <div th:if="${credito.interes != null}" class="summary-item financial-field">
                    <div class="summary-label">Monto Interés</div>
                    <div class="summary-value" th:text="${'$' + #numbers.formatDecimal(credito.interes, 1, 'COMMA', 2, 'POINT')}"></div>
                </div>
                <div th:if="${credito.mora != null}" class="summary-item financial-field">
                    <div class="summary-label">Monto Mora</div>
                    <div class="summary-value" th:text="${'$' + #numbers.formatDecimal(credito.mora, 1, 'COMMA', 2, 'POINT')}"></div>
                </div>
                <div th:if="${credito.iva != null}" class="summary-item financial-field">
                    <div class="summary-label">Monto IVA</div>
                    <div class="summary-value" th:text="${'$' + #numbers.formatDecimal(credito.iva, 1, 'COMMA', 2, 'POINT')}"></div>
                </div>
                <div th:if="${credito.total != null}" class="summary-item financial-field total-highlight">
                    <div class="summary-label">Monto Total</div>
                    <div class="summary-value" th:text="${'$' + #numbers.formatDecimal(credito.total, 1, 'COMMA', 2, 'POINT')}"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Financial Charges Details - Full Width Section -->
    <div class="section-card full-width" th:if="${credito.porcentajeInteres != null}">
        <div class="section-header">
            <div class="section-header-left">
                <i class="fas fa-calculator"></i>
                Detalles de los Cargos Financieros
            </div>
        </div>
        <div class="section-content">
            <div class="info-grid" style="grid-template-columns: 1fr 1fr;">
                <div class="info-item">
                    <span class="info-label">Porcentaje Interés</span>
                    <span class="info-value" th:text="${#numbers.formatDecimal(credito.porcentajeInteres, 1, 2) + '%'}"></span>
                </div>
                <div class="info-item">
                    <span class="info-label">Porcentaje Mora</span>
                    <span class="info-value" th:text="${#numbers.formatDecimal(credito.porcentajeMora, 1, 2) + '%'}"></span>
                </div>
                <div class="info-item">
                    <span class="info-label">Porcentaje IVA</span>
                    <span class="info-value" th:text="${#numbers.formatDecimal(credito.porcentajeIva, 1, 2) + '%'}"></span>
                </div>
                <div class="info-item">
                    <span class="info-label">Comisión Fija</span>
                    <span class="info-value" th:text="${'$' + #numbers.formatDecimal(credito.comisionFija, 1, 'COMMA', 2, 'POINT')}"></span>
                </div>
            </div>
        </div>
    </div>

    <div class="sections-grid">
        <!-- Personal Information -->
        <div class="section-card" th:if="${credito.usuarioSolicitud != null}">
            <div class="section-header" onclick="toggleSection('personal-info')">
                <div class="section-header-left">
                    <i class="fas fa-user"></i>
                    Información Personal
                </div>
                <button class="section-toggle collapsed" id="personal-info-toggle">
                    <i class="fas fa-chevron-down"></i>
                </button>
            </div>
            <div class="section-content" id="personal-info-content" style="max-height: 0px; padding-top: 0px; padding-bottom: 0px; overflow: hidden;">
                <div class="info-grid">
                    <div class="info-item important-field">
                        <span class="info-label">Nombres</span>
                        <span class="info-value" th:text="${credito.usuarioSolicitud.nombres}">Juan Carlos</span>
                    </div>
                    <div class="info-item important-field">
                        <span class="info-label">Apellidos</span>
                        <span class="info-value" th:text="${credito.usuarioSolicitud.apellidos}">Pérez González</span>
                    </div>
                    <div class="info-item important-field">
                        <span class="info-label">Foto del DUI</span>
                        <div class="info-value">
                            <img th:src="@{${credito.usuarioSolicitud.dui}}" alt="Foto DUI"
                                 style="max-width: 100%; height: auto; border-radius: 8px; border: 1px solid #ccc; cursor: pointer;"
                                 onclick="showDuiModal(this.src)" />
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- User Account Information -->
        <div class="section-card" th:if="${credito.usuario != null}">
            <div class="section-header" onclick="toggleSection('account-info')">
                <div class="section-header-left">
                    <i class="fas fa-user-circle"></i>
                    Información de la Cuenta
                </div>
                <button class="section-toggle collapsed" id="account-info-toggle">
                    <i class="fas fa-chevron-down"></i>
                </button>
            </div>
            <div class="section-content" id="account-info-content" style="max-height: 0px; padding-top: 0px; padding-bottom: 0px; overflow: hidden;">
                <div class="info-grid">
                    <div class="info-item important-field">
                        <span class="info-label">Nombre Completo</span>
                        <span class="info-value" th:text="${credito.usuario.nombre != null ? credito.usuario.nombre : 'N/A'}">Juan Pérez</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Correo Electrónico</span>
                        <span class="info-value" th:text="${credito.usuario.email != null ? credito.usuario.email : 'N/A'}">juan@email.com</span>
                        <div class="contact-info">
                            <i class="fas fa-envelope contact-icon"></i>
                            <span style="font-size: 12px; color: #6c757d;">Correo principal</span>
                        </div>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Teléfono Móvil</span>
                        <span class="info-value" th:text="${credito.usuario.celular != null ? credito.usuario.celular : 'N/A'}">+503 1234-5678</span>
                        <div class="contact-info">
                            <i class="fas fa-phone contact-icon"></i>
                            <span style="font-size: 12px; color: #6c757d;">Contacto principal</span>
                        </div>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Dirección Residencial</span>
                        <span class="info-value" th:text="${credito.usuario.direccion != null ? credito.usuario.direccion : 'N/A'}">San Salvador, El Salvador</span>
                        <div class="contact-info">
                            <i class="fas fa-map-marker-alt contact-icon"></i>
                            <span style="font-size: 12px; color: #6c757d;">Dirección registrada</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Work Information -->
        <div class="section-card" th:if="${credito.usuarioSolicitud != null}">
            <div class="section-header" onclick="toggleSection('work-info')">
                <div class="section-header-left">
                    <i class="fas fa-briefcase"></i>
                    Información Laboral
                </div>
                <button class="section-toggle collapsed" id="work-info-toggle">
                    <i class="fas fa-chevron-down"></i>
                </button>
            </div>
            <div class="section-content" id="work-info-content" style="max-height: 0px; padding-top: 0px; padding-bottom: 0px; overflow: hidden;">
                <div class="info-grid">
                    <div class="info-item">
                        <span class="info-label">Empresa o Institución</span>
                        <span class="info-value" th:text="${credito.usuarioSolicitud.empresaTrabajo}">Tech Solutions S.A.</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Cargo o Puesto</span>
                        <span class="info-value" th:text="${credito.usuarioSolicitud.puesto}">Desarrollador Senior</span>
                    </div>
                    <div class="info-item financial-field">
                        <span class="info-label">Ingreso Mensual</span>
                        <span class="info-value amount-highlight" th:text="${'$' + credito.usuarioSolicitud.ingresoMensual}">$2,500.00</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Tipo de Contrato</span>
                        <span class="info-value" th:text="${credito.usuarioSolicitud.tipoContrato}">Indefinido</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Contact Information -->
        <div class="section-card" th:if="${credito.usuarioSolicitud != null}">
            <div class="section-header" onclick="toggleSection('contact-info')">
                <div class="section-header-left">
                    <i class="fas fa-address-book"></i>
                    Información de Contacto
                </div>
                <button class="section-toggle collapsed" id="contact-info-toggle">
                    <i class="fas fa-chevron-down"></i>
                </button>
            </div>
            <div class="section-content" id="contact-info-content" style="max-height: 0px; padding-top: 0px; padding-bottom: 0px; overflow: hidden;">
                <div class="info-grid">
                    <div class="info-item">
                        <span class="info-label">Teléfono de Contacto</span>
                        <span class="info-value" th:text="${credito.usuarioSolicitud.telefono}">+503 1234-5678</span>
                        <div class="contact-info">
                            <i class="fas fa-phone contact-icon"></i>
                            <span style="font-size: 12px; color: #6c757d;">Teléfono de la solicitud</span>
                        </div>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Correo Electrónico</span>
                        <span class="info-value" th:text="${credito.usuarioSolicitud.email}">juan@email.com</span>
                        <div class="contact-info">
                            <i class="fas fa-envelope contact-icon"></i>
                            <span style="font-size: 12px; color: #6c757d;">Email de la solicitud</span>
                        </div>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Dirección Residencial</span>
                        <span class="info-value" th:text="${credito.usuarioSolicitud.direccion}">San Salvador, El Salvador</span>
                        <div class="contact-info">
                            <i class="fas fa-map-marker-alt contact-icon"></i>
                            <span style="font-size: 12px; color: #6c757d;">Dirección de la solicitud</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Credit Details - Full Width Section -->
    <div class="section-card full-width">
        <div class="section-header" onclick="toggleSection('credit-details')">
            <div class="section-header-left">
                <i class="fas fa-info-circle"></i>
                Detalles del Crédito
            </div>
            <button class="section-toggle collapsed" id="credit-details-toggle">
                <i class="fas fa-chevron-down"></i>
            </button>
        </div>
        <div class="section-content" id="credit-details-content" style="max-height: 0px; padding-top: 0px; padding-bottom: 0px; overflow: hidden;">
            <div class="info-grid" style="grid-template-columns: 1fr 1fr;">
                <div class="info-item">
                    <span class="info-label">Destino del Crédito</span>
                    <span class="info-value" th:text="${credito.destino != null ? credito.destino : 'No especificado'}">Personal</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Forma de Pago</span>
                    <span class="info-value" th:text="${credito.formaDePago != null ? credito.formaDePago : 'No especificado'}">Mensual</span>
                </div>
            </div>
        </div>
    </div>

    <!-- References -->
    <div class="section-card" th:if="${credito.usuarioSolicitud != null}">
        <div class="section-header" onclick="toggleSection('references')">
            <div class="section-header-left">
                <i class="fas fa-users"></i>
                Referencias Personales
            </div>
            <button class="section-toggle collapsed" id="references-toggle">
                <i class="fas fa-chevron-down"></i>
            </button>
        </div>
        <div class="section-content" id="references-content" style="max-height: 0px; padding-top: 0px; padding-bottom: 0px; overflow: hidden;">
            <div class="info-grid" style="grid-template-columns: 1fr 1fr;">
                <div class="info-item">
                    <span class="info-label">Primera Referencia</span>
                    <span class="info-value" th:text="${credito.usuarioSolicitud.referencia1}">María González</span>
                    <div class="contact-info">
                        <i class="fas fa-phone contact-icon"></i>
                        <span class="info-value" th:text="${credito.usuarioSolicitud.telefonoReferencia1}">+503 9876-5432</span>
                    </div>
                    <span class="info-label" style="margin-top: 6px;">Relación</span>
                    <span class="info-value" th:text="${credito.usuarioSolicitud.parentesco1}">Hermana</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Segunda Referencia</span>
                    <span class="info-value" th:text="${credito.usuarioSolicitud.referencia2}">Carlos Rodríguez</span>
                    <div class="contact-info">
                        <i class="fas fa-phone contact-icon"></i>
                        <span class="info-value" th:text="${credito.usuarioSolicitud.telefonoReferencia2}">+503 5555-1234</span>
                    </div>
                    <span class="info-label" style="margin-top: 6px;">Relación</span>
                    <span class="info-value" th:text="${credito.usuarioSolicitud.parentesco2}">Amigo</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Application Details -->
    <div class="section-card" th:if="${credito.usuarioSolicitud != null}">
        <div class="section-header" onclick="toggleSection('application-details')">
            <div class="section-header-left">
                <i class="fas fa-clipboard-check"></i>
                Detalles de la Solicitud
            </div>
            <button class="section-toggle collapsed" id="application-details-toggle">
                <i class="fas fa-chevron-down"></i>
            </button>
        </div>
        <div class="section-content" id="application-details-content" style="max-height: 0px; padding-top: 0px; padding-bottom: 0px; overflow: hidden;">
            <div class="info-grid" style="grid-template-columns: 1fr 1fr;">
                <div class="info-item">
                    <span class="info-label">Firma del Solicitante</span>
                    <span class="info-value" th:text="${credito.usuarioSolicitud.firma}">Juan C. Pérez</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Fecha de Solicitud</span>
                    <span class="info-value" th:text="${credito.usuarioSolicitud.fechaSolicitud}">15/01/2024</span>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal para ampliar foto del DUI -->
<div class="modal fade" id="duiModal" tabindex="-1" role="dialog" aria-labelledby="duiModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
        <div class="modal-content bg-dark text-white">
            <div class="modal-header border-0">
                <h5 class="modal-title" id="duiModalLabel">Visualización de Foto del DUI</h5>
                <button type="button" class="close text-white" data-dismiss="modal" aria-label="Cerrar">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body text-center">
                <img id="duiModalImg" src="" alt="Foto DUI Ampliada" style="max-width: 100%; height: auto; border-radius: 8px;">
            </div>
        </div>
    </div>
</div>

<script>
    // Asegúrate de que este script se ejecute después de que jQuery y Bootstrap estén cargados
    document.addEventListener('DOMContentLoaded', function() {
        // Función para mostrar el modal con la imagen del DUI
        window.showDuiModal = function(imageSrc) {
            document.getElementById('duiModalImg').src = imageSrc;
            $('#duiModal').modal('show');
        };
    });
</script>